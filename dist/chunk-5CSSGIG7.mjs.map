{"version":3,"sources":["../src/hooks/use-streaming.ts","../src/hooks/use-attachments.ts"],"names":["useStreaming","options","state","setState","useState","abortControllerRef","useRef","startStreaming","useCallback","messageId","appendContent","chunk","prev","stopStreaming","finalContent","handleError","error","useAttachments","maxCount","maxFileSize","allowedTypes","attachments","setAttachments","addAttachment","file","id","removeAttachment","updateProgress","progress","a","setError","setUrl","url","clear","getFiles"],"mappings":"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","file":"chunk-5CSSGIG7.mjs","sourcesContent":["import { useState, useCallback, useRef } from \"react\";\nimport type { StreamingState, StreamChunk, StreamingOptions } from \"../types\";\n\n/**\n * Hook to manage streaming message state.\n */\nexport function useStreaming(options: StreamingOptions = {}) {\n  const [state, setState] = useState<StreamingState>({\n    isStreaming: false,\n    streamingMessageId: null,\n    streamedContent: \"\",\n  });\n\n  const abortControllerRef = useRef<AbortController | null>(null);\n\n  const startStreaming = useCallback((messageId: string) => {\n    setState({\n      isStreaming: true,\n      streamingMessageId: messageId,\n      streamedContent: \"\",\n    });\n    abortControllerRef.current = new AbortController();\n  }, []);\n\n  const appendContent = useCallback(\n    (chunk: StreamChunk) => {\n      if (chunk.type === \"content\" && chunk.content) {\n        setState((prev) => ({\n          ...prev,\n          streamedContent: prev.streamedContent + chunk.content,\n        }));\n      }\n      options.onChunk?.(chunk);\n    },\n    [options]\n  );\n\n  const stopStreaming = useCallback(() => {\n    abortControllerRef.current?.abort();\n    const finalContent = state.streamedContent;\n\n    setState({\n      isStreaming: false,\n      streamingMessageId: null,\n      streamedContent: \"\",\n    });\n\n    options.onComplete?.(finalContent);\n  }, [state.streamedContent, options]);\n\n  const handleError = useCallback(\n    (error: Error) => {\n      abortControllerRef.current?.abort();\n      setState({\n        isStreaming: false,\n        streamingMessageId: null,\n        streamedContent: \"\",\n      });\n      options.onError?.(error);\n    },\n    [options]\n  );\n\n  return {\n    ...state,\n    startStreaming,\n    appendContent,\n    stopStreaming,\n    handleError,\n    abortSignal: abortControllerRef.current?.signal,\n  };\n}\n","import { useState, useCallback } from \"react\";\n\ninterface AttachmentState {\n  file: File;\n  id: string;\n  progress: number;\n  status: \"pending\" | \"uploading\" | \"complete\" | \"error\";\n  error?: string;\n  url?: string;\n}\n\ninterface UseAttachmentsOptions {\n  /** Maximum number of attachments */\n  maxCount?: number;\n  /** Maximum file size in bytes */\n  maxFileSize?: number;\n  /** Allowed MIME types */\n  allowedTypes?: string[];\n}\n\n/**\n * Hook to manage file attachments with upload progress.\n */\nexport function useAttachments({\n  maxCount = 5,\n  maxFileSize = 10 * 1024 * 1024,\n  allowedTypes,\n}: UseAttachmentsOptions = {}) {\n  const [attachments, setAttachments] = useState<AttachmentState[]>([]);\n\n  const addAttachment = useCallback(\n    (file: File): { success: boolean; error?: string } => {\n      // Check count\n      if (attachments.length >= maxCount) {\n        return { success: false, error: `Maximum ${maxCount} attachments allowed` };\n      }\n\n      // Check size\n      if (file.size > maxFileSize) {\n        return {\n          success: false,\n          error: `File size exceeds ${Math.round(maxFileSize / 1024 / 1024)}MB limit`,\n        };\n      }\n\n      // Check type\n      if (allowedTypes && !allowedTypes.includes(file.type)) {\n        return { success: false, error: `File type ${file.type} not allowed` };\n      }\n\n      const id = `${Date.now()}-${Math.random().toString(36).slice(2)}`;\n\n      setAttachments((prev) => [\n        ...prev,\n        {\n          file,\n          id,\n          progress: 0,\n          status: \"pending\",\n        },\n      ]);\n\n      return { success: true };\n    },\n    [attachments.length, maxCount, maxFileSize, allowedTypes]\n  );\n\n  const removeAttachment = useCallback((id: string) => {\n    setAttachments((prev) => prev.filter((a) => a.id !== id));\n  }, []);\n\n  const updateProgress = useCallback((id: string, progress: number) => {\n    setAttachments((prev) =>\n      prev.map((a) =>\n        a.id === id\n          ? { ...a, progress, status: progress < 100 ? \"uploading\" : \"complete\" }\n          : a\n      )\n    );\n  }, []);\n\n  const setError = useCallback((id: string, error: string) => {\n    setAttachments((prev) =>\n      prev.map((a) => (a.id === id ? { ...a, status: \"error\", error } : a))\n    );\n  }, []);\n\n  const setUrl = useCallback((id: string, url: string) => {\n    setAttachments((prev) =>\n      prev.map((a) => (a.id === id ? { ...a, url, status: \"complete\", progress: 100 } : a))\n    );\n  }, []);\n\n  const clear = useCallback(() => {\n    setAttachments([]);\n  }, []);\n\n  const getFiles = useCallback(() => {\n    return attachments.map((a) => a.file);\n  }, [attachments]);\n\n  return {\n    attachments,\n    addAttachment,\n    removeAttachment,\n    updateProgress,\n    setError,\n    setUrl,\n    clear,\n    getFiles,\n    canAddMore: attachments.length < maxCount,\n  };\n}\n"]}