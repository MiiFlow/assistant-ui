{"version":3,"sources":["../src/hooks/use-auto-scroll.ts","../src/hooks/use-message-composer.ts"],"names":["useAutoScroll","enabled","threshold","smooth","containerRef","useRef","shouldScrollRef","handleScroll","useCallback","container","scrollTop","scrollHeight","clientHeight","distanceFromBottom","scrollToBottom","force","useEffect","useMessageComposer","onSubmit","disabled","maxFileSize","allowedFileTypes","content","setContent","useState","attachments","setAttachments","isSubmitting","setIsSubmitting","error","setError","inputRef","handleContentChange","value","handleAddAttachment","files","fileArray","validFiles","file","prev","handleRemoveAttachment","index","_","i","handleSubmit","trimmedContent","err","handleKeyDown","e","clear","canSubmit"],"mappings":"wCAeO,SAASA,CAAAA,CAAqC,CACnD,OAAA,CAAAC,CAAAA,CAAU,KACV,SAAA,CAAAC,CAAAA,CAAY,GAAA,CACZ,MAAA,CAAAC,CAAAA,CAAS,IACX,EAA0B,EAAC,CAAG,CAC5B,IAAMC,CAAAA,CAAeC,YAAAA,CAAU,IAAI,CAAA,CAC7BC,CAAAA,CAAkBD,YAAAA,CAAO,IAAI,CAAA,CAG7BE,CAAAA,CAAeC,kBAAY,IAAM,CACrC,IAAMC,CAAAA,CAAYL,CAAAA,CAAa,OAAA,CAC/B,GAAI,CAACK,CAAAA,CAAW,OAEhB,GAAM,CAAE,SAAA,CAAAC,CAAAA,CAAW,YAAA,CAAAC,CAAAA,CAAc,YAAA,CAAAC,CAAa,CAAA,CAAIH,CAAAA,CAC5CI,CAAAA,CAAqBF,EAAeD,CAAAA,CAAYE,CAAAA,CAGtDN,CAAAA,CAAgB,OAAA,CAAUO,CAAAA,EAAsBX,EAClD,EAAG,CAACA,CAAS,CAAC,CAAA,CAGRY,CAAAA,CAAiBN,iBAAAA,CACrB,CAACO,CAAAA,CAAQ,KAAA,GAAU,CACjB,IAAMN,CAAAA,CAAYL,CAAAA,CAAa,OAAA,CAC1BK,CAAAA,GAEDM,CAAAA,EAAST,CAAAA,CAAgB,OAAA,CAAA,EAC3BG,CAAAA,CAAU,QAAA,CAAS,CACjB,IAAKA,CAAAA,CAAU,YAAA,CACf,QAAA,CAAUN,CAAAA,CAAS,QAAA,CAAW,MAChC,CAAC,EAEL,CAAA,CACA,CAACA,CAAM,CACT,CAAA,CAGA,OAAAa,eAAAA,CAAU,IAAM,CACVf,CAAAA,EACFa,CAAAA,GAEJ,CAAA,CAAG,CAACb,CAAAA,CAASa,CAAc,CAAC,CAAA,CAG5BE,eAAAA,CAAU,IAAM,CACd,IAAMP,CAAAA,CAAYL,CAAAA,CAAa,OAAA,CAC/B,GAAKK,CAAAA,CAEL,OAAAA,CAAAA,CAAU,gBAAA,CAAiB,QAAA,CAAUF,CAAAA,CAAc,CAAE,OAAA,CAAS,IAAK,CAAC,CAAA,CAC7D,IAAME,CAAAA,CAAU,mBAAA,CAAoB,QAAA,CAAUF,CAAY,CACnE,CAAA,CAAG,CAACA,CAAY,CAAC,CAAA,CAEV,CACL,YAAA,CAAAH,CAAAA,CACA,cAAA,CAAAU,CAAAA,CACA,UAAA,CAAYR,CAAAA,CAAgB,OAC9B,CACF,CCxDO,SAASW,CAAAA,CAAmB,CACjC,QAAA,CAAAC,CAAAA,CACA,QAAA,CAAAC,CAAAA,CAAW,KAAA,CACX,WAAA,CAAAC,CAAAA,CAAc,EAAA,CAAK,KAAO,IAAA,CAC1B,gBAAA,CAAAC,CACF,CAAA,CAA8B,CAC5B,GAAM,CAACC,CAAAA,CAASC,CAAU,CAAA,CAAIC,cAAAA,CAAS,EAAE,CAAA,CACnC,CAACC,CAAAA,CAAaC,CAAc,CAAA,CAAIF,cAAAA,CAAiB,EAAE,CAAA,CACnD,CAACG,CAAAA,CAAcC,CAAe,CAAA,CAAIJ,cAAAA,CAAS,KAAK,CAAA,CAChD,CAACK,CAAAA,CAAOC,CAAQ,CAAA,CAAIN,cAAAA,CAAwB,IAAI,CAAA,CAEhDO,EAAW1B,YAAAA,CAA4B,IAAI,CAAA,CAE3C2B,CAAAA,CAAsBxB,iBAAAA,CAAayB,CAAAA,EAAkB,CACzDV,CAAAA,CAAWU,CAAK,CAAA,CAChBH,CAAAA,CAAS,IAAI,EACf,CAAA,CAAG,EAAE,CAAA,CAECI,CAAAA,CAAsB1B,iBAAAA,CACzB2B,CAAAA,EAA6B,CAC5B,IAAMC,CAAAA,CAAY,KAAA,CAAM,IAAA,CAAKD,CAAK,CAAA,CAC5BE,CAAAA,CAAqB,EAAC,CAE5B,IAAA,IAAWC,CAAAA,IAAQF,CAAAA,CAAW,CAE5B,GAAIE,EAAK,IAAA,CAAOlB,CAAAA,CAAa,CAC3BU,CAAAA,CAAS,CAAA,MAAA,EAASQ,CAAAA,CAAK,IAAI,CAAA,sBAAA,CAAwB,CAAA,CACnD,QACF,CAGA,GAAIjB,CAAAA,EAAoB,CAACA,CAAAA,CAAiB,QAAA,CAASiB,CAAAA,CAAK,IAAI,CAAA,CAAG,CAC7DR,EAAS,CAAA,WAAA,EAAcQ,CAAAA,CAAK,IAAI,CAAA,gBAAA,CAAkB,CAAA,CAClD,QACF,CAEAD,CAAAA,CAAW,IAAA,CAAKC,CAAI,EACtB,CAEAZ,CAAAA,CAAgBa,CAAAA,EAAS,CAAC,GAAGA,CAAAA,CAAM,GAAGF,CAAU,CAAC,EACnD,EACA,CAACjB,CAAAA,CAAaC,CAAgB,CAChC,CAAA,CAEMmB,CAAAA,CAAyBhC,kBAAaiC,CAAAA,EAAkB,CAC5Df,CAAAA,CAAgBa,CAAAA,EAASA,CAAAA,CAAK,MAAA,CAAO,CAACG,CAAAA,CAAGC,CAAAA,GAAMA,CAAAA,GAAMF,CAAK,CAAC,EAC7D,CAAA,CAAG,EAAE,CAAA,CAECG,CAAAA,CAAepC,iBAAAA,CAAY,SAAY,CAC3C,IAAMqC,CAAAA,CAAiBvB,CAAAA,CAAQ,IAAA,EAAK,CACpC,GAAK,EAAA,CAACuB,GAAkBpB,CAAAA,CAAY,MAAA,GAAW,CAAA,EAAMN,CAAAA,EAAYQ,CAAAA,CAAAA,CAIjE,CAAAC,EAAgB,IAAI,CAAA,CACpBE,CAAAA,CAAS,IAAI,CAAA,CAEb,GAAI,CACF,MAAMZ,CAAAA,CAAS2B,CAAAA,CAAgBpB,CAAAA,CAAY,MAAA,CAAS,CAAA,CAAIA,CAAAA,CAAc,MAAS,CAAA,CAC/EF,CAAAA,CAAW,EAAE,CAAA,CACbG,CAAAA,CAAe,EAAE,CAAA,CACjBK,CAAAA,CAAS,OAAA,EAAS,KAAA,GACpB,CAAA,MAASe,EAAK,CACZhB,CAAAA,CAASgB,CAAAA,YAAe,KAAA,CAAQA,CAAAA,CAAI,OAAA,CAAU,wBAAwB,EACxE,CAAA,OAAE,CACAlB,CAAAA,CAAgB,KAAK,EACvB,EACF,CAAA,CAAG,CAACN,CAAAA,CAASG,CAAAA,CAAaN,CAAAA,CAAUQ,CAAAA,CAAcT,CAAQ,CAAC,CAAA,CAErD6B,CAAAA,CAAgBvC,iBAAAA,CACnBwC,CAAAA,EAA0C,CAErCA,EAAE,GAAA,GAAQ,OAAA,EAAW,CAACA,CAAAA,CAAE,QAAA,GAC1BA,CAAAA,CAAE,cAAA,EAAe,CACjBJ,CAAAA,EAAa,EAEjB,CAAA,CACA,CAACA,CAAY,CACf,EAEMK,CAAAA,CAAQzC,iBAAAA,CAAY,IAAM,CAC9Be,CAAAA,CAAW,EAAE,EACbG,CAAAA,CAAe,EAAE,CAAA,CACjBI,CAAAA,CAAS,IAAI,EACf,CAAA,CAAG,EAAE,CAAA,CAECoB,CAAAA,CAAAA,CAAa5B,CAAAA,CAAQ,IAAA,EAAK,EAAKG,CAAAA,CAAY,MAAA,CAAS,CAAA,GAAM,CAACN,CAAAA,EAAY,CAACQ,EAE9E,OAAO,CACL,OAAA,CAAAL,CAAAA,CACA,WAAA,CAAAG,CAAAA,CACA,aAAAE,CAAAA,CACA,KAAA,CAAAE,CAAAA,CACA,SAAA,CAAAqB,CAAAA,CACA,QAAA,CAAAnB,EACA,mBAAA,CAAAC,CAAAA,CACA,mBAAA,CAAAE,CAAAA,CACA,sBAAA,CAAAM,CAAAA,CACA,YAAA,CAAAI,CAAAA,CACA,aAAA,CAAAG,CAAAA,CACA,KAAA,CAAAE,CACF,CACF","file":"chunk-ILIS3GX7.js","sourcesContent":["import { useEffect, useRef, useCallback } from \"react\";\n\ninterface UseAutoScrollOptions {\n  /** Whether auto-scroll is enabled */\n  enabled?: boolean;\n  /** Threshold from bottom to trigger auto-scroll (pixels) */\n  threshold?: number;\n  /** Smooth scroll behavior */\n  smooth?: boolean;\n}\n\n/**\n * Hook to automatically scroll to the bottom of a container\n * when new content is added, unless the user has scrolled up.\n */\nexport function useAutoScroll<T extends HTMLElement>({\n  enabled = true,\n  threshold = 100,\n  smooth = true,\n}: UseAutoScrollOptions = {}) {\n  const containerRef = useRef<T>(null);\n  const shouldScrollRef = useRef(true);\n\n  // Track if user has scrolled away from bottom\n  const handleScroll = useCallback(() => {\n    const container = containerRef.current;\n    if (!container) return;\n\n    const { scrollTop, scrollHeight, clientHeight } = container;\n    const distanceFromBottom = scrollHeight - scrollTop - clientHeight;\n\n    // User is near bottom, enable auto-scroll\n    shouldScrollRef.current = distanceFromBottom <= threshold;\n  }, [threshold]);\n\n  // Scroll to bottom\n  const scrollToBottom = useCallback(\n    (force = false) => {\n      const container = containerRef.current;\n      if (!container) return;\n\n      if (force || shouldScrollRef.current) {\n        container.scrollTo({\n          top: container.scrollHeight,\n          behavior: smooth ? \"smooth\" : \"auto\",\n        });\n      }\n    },\n    [smooth]\n  );\n\n  // Auto-scroll when enabled changes or container updates\n  useEffect(() => {\n    if (enabled) {\n      scrollToBottom();\n    }\n  }, [enabled, scrollToBottom]);\n\n  // Attach scroll listener\n  useEffect(() => {\n    const container = containerRef.current;\n    if (!container) return;\n\n    container.addEventListener(\"scroll\", handleScroll, { passive: true });\n    return () => container.removeEventListener(\"scroll\", handleScroll);\n  }, [handleScroll]);\n\n  return {\n    containerRef,\n    scrollToBottom,\n    isAtBottom: shouldScrollRef.current,\n  };\n}\n","import { useState, useCallback, useRef, type KeyboardEvent } from \"react\";\n\ninterface UseMessageComposerOptions {\n  /** Callback when message is submitted */\n  onSubmit: (content: string, attachments?: File[]) => Promise<void>;\n  /** Whether submission is disabled */\n  disabled?: boolean;\n  /** Maximum file size in bytes */\n  maxFileSize?: number;\n  /** Allowed file types (MIME types) */\n  allowedFileTypes?: string[];\n}\n\n/**\n * Hook to manage message composer state and behavior.\n */\nexport function useMessageComposer({\n  onSubmit,\n  disabled = false,\n  maxFileSize = 10 * 1024 * 1024, // 10MB\n  allowedFileTypes,\n}: UseMessageComposerOptions) {\n  const [content, setContent] = useState(\"\");\n  const [attachments, setAttachments] = useState<File[]>([]);\n  const [isSubmitting, setIsSubmitting] = useState(false);\n  const [error, setError] = useState<string | null>(null);\n\n  const inputRef = useRef<HTMLTextAreaElement>(null);\n\n  const handleContentChange = useCallback((value: string) => {\n    setContent(value);\n    setError(null);\n  }, []);\n\n  const handleAddAttachment = useCallback(\n    (files: FileList | File[]) => {\n      const fileArray = Array.from(files);\n      const validFiles: File[] = [];\n\n      for (const file of fileArray) {\n        // Check file size\n        if (file.size > maxFileSize) {\n          setError(`File \"${file.name}\" exceeds maximum size`);\n          continue;\n        }\n\n        // Check file type\n        if (allowedFileTypes && !allowedFileTypes.includes(file.type)) {\n          setError(`File type \"${file.type}\" is not allowed`);\n          continue;\n        }\n\n        validFiles.push(file);\n      }\n\n      setAttachments((prev) => [...prev, ...validFiles]);\n    },\n    [maxFileSize, allowedFileTypes]\n  );\n\n  const handleRemoveAttachment = useCallback((index: number) => {\n    setAttachments((prev) => prev.filter((_, i) => i !== index));\n  }, []);\n\n  const handleSubmit = useCallback(async () => {\n    const trimmedContent = content.trim();\n    if ((!trimmedContent && attachments.length === 0) || disabled || isSubmitting) {\n      return;\n    }\n\n    setIsSubmitting(true);\n    setError(null);\n\n    try {\n      await onSubmit(trimmedContent, attachments.length > 0 ? attachments : undefined);\n      setContent(\"\");\n      setAttachments([]);\n      inputRef.current?.focus();\n    } catch (err) {\n      setError(err instanceof Error ? err.message : \"Failed to send message\");\n    } finally {\n      setIsSubmitting(false);\n    }\n  }, [content, attachments, disabled, isSubmitting, onSubmit]);\n\n  const handleKeyDown = useCallback(\n    (e: KeyboardEvent<HTMLTextAreaElement>) => {\n      // Submit on Enter without Shift\n      if (e.key === \"Enter\" && !e.shiftKey) {\n        e.preventDefault();\n        handleSubmit();\n      }\n    },\n    [handleSubmit]\n  );\n\n  const clear = useCallback(() => {\n    setContent(\"\");\n    setAttachments([]);\n    setError(null);\n  }, []);\n\n  const canSubmit = (content.trim() || attachments.length > 0) && !disabled && !isSubmitting;\n\n  return {\n    content,\n    attachments,\n    isSubmitting,\n    error,\n    canSubmit,\n    inputRef,\n    handleContentChange,\n    handleAddAttachment,\n    handleRemoveAttachment,\n    handleSubmit,\n    handleKeyDown,\n    clear,\n  };\n}\n"]}